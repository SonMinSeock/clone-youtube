(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=(document.querySelector(".video__comments ul"),document.querySelectorAll(".delete__icon")),a=async t=>{const n=t.target.parentElement,{dataset:{id:a}}=t.target.parentElement,o=e.dataset.id;201===(await fetch(`/api/videos/${o}/comment/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:a})})).status&&n.remove()};t&&t.addEventListener("submit",(async n=>{n.preventDefault();const o=t.querySelector("textarea"),d=o.value,c=e.dataset.id;if(""===d)return;const m=await fetch(`/api/videos/${c}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:d})});if(201===m.status){o.value="";const{newCommentId:e}=await m.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),o=document.createElement("li");o.dataset.id=t;const d=document.createElement("i"),c=document.createElement("span"),m=document.createElement("span");o.className="video__comment",d.className="fas fa-comment",m.className="delete__icon",o.appendChild(d),c.innerText=` ${e}`,m.innerText="❌",o.appendChild(c),o.appendChild(m),n.prepend(o),m.addEventListener("click",a)})(d,e)}})),n&&n.forEach((e=>e.addEventListener("click",a)))})();